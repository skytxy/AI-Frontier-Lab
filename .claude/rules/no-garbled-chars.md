# 禁止乱码字符规则 (No Garbled Characters)

**重要**: 此规则确保生成的代码和文档**绝无乱码**，维护教育网站的专业性。

## 禁止使用的特殊字符

### 1. 箭头符号

| 符号 | 编码 | 禁用原因 | 替代方案 |
|------|------|----------|----------|
| `→` | U+2192 | 易乱码 | 使用 `->` 或 ASCII `→` |
| `←` | U+2190 | 易乱码 | 使用 `<-` |
| `↑` | U+2191 | 易乱码 | 使用 `↑` (仅在必要时) |
| `↓` | U+2193 | 易乱码 | 使用 `↓` (仅在必要时) |
| `↠` | U+21A0 | 易乱码 | 使用 `==>` |
| `◀` | U+25C0 | 易乱码 | 使用 `<--` |
| `▶` | U+25B6 | 易乱码 | 使用 `-->` |

**规则**:
```markdown
# ❌ 错误：使用易乱码的箭头
学习路线：概念 → 协议 → 实现

# ✅ 正确：使用 ASCII 箭头
学习路线：概念 -> 协议 -> 实现

# ✅ 正确：使用文字描述
学习路线：概念到协议到实现
```

### 2. 中文标点符号

| 符号 | 使用场景 | 规范 |
|------|---------|------|
| `：` | 中文标题 | ✅ 允许（统一使用） |
| `:` | 英文标题 | ✅ 允许 |
| `，` | 中文文本 | ✅ 允许 |
| `,` | 英文文本、代码 | ✅ 允许 |
| `。` | 中文段落结尾 | ✅ 允许 |
| `.` | 英文、代码 | ✅ 允许 |
| `（` `）` | 中文括号 | ✅ 允许 |
| `(` `)` | 英文、代码 | ✅ 允许 |
| `"` `"` | 中文引号 | ⚠️ 谨慎使用 |
| `"` `"` | 英文、代码 | ✅ 允许 |
| `'` `'` | 中文单引号 | ⚠️ 谨慎使用 |
| `'` `'` | 英文、代码 | ✅ 允许 |

**规则**: 在同一文档中保持标点符号风格一致

### 3. 特殊 Unicode 字符

**禁止使用** (除非在代码块中):

```markdown
❌ → ❌ ← ❌ ↑ ❌ ↓  # 箭头
❌ ◀ ❌ ▶ ❌ ◈      # 三角
❌ ✓ ❌ ✗           # 对勾和叉号（使用 ✅ ❌）
❌ ⚠ ❌ ✅          # 其他符号
```

**允许使用**:

```markdown
✅ ✅ ❌ 🚧 🎯 📚  # 带颜色效果的符号
✅ ←→  # 仅在必要时使用代码块中
✅ → ←  # 仅在必要时使用代码块中
```

## 安全字符列表

### Markdown 文本

**完全安全的字符**:
- ASCII (0x00-0x7F)
- 常用中文: `你好学习路线协议实现安全攻防`
- 常用标点: `，。：；（）【】《》`
- 安全箭头: `->` `<-` `==>` `<--` `-->`

### 代码块

**任何字符都可以** (在代码块中):

````
代码块内的特殊字符不受限制
→ ← ↑ ↓ 都可以
```

## 创建文件时的检查清单

在创建或编辑 Markdown 文件时，必须：

1. **使用纯 ASCII 箭头**
   ```bash
   # ✅ 正确
   echo "Step 1 -> Step 2 -> Step 3"

   # ❌ 错误
   echo "Step 1 → Step 2 → Step 3"
   ```

2. **统一标点符号**
   ```bash
   # ✅ 正确：中文用中文标点
   echo "学习路线：概念到协议"

   # ✅ 正确：英文用英文标点
   echo "Learning path: concepts to protocols"
   ```

3. **使用 Python 确保编码**
   ```python
   # ✅ 使用 Python 写入文件（确保 UTF-8）
   with open('file.md', 'w', encoding='utf-8') as f:
       f.write("内容")
   ```

## 验证方法

创建文件后，必须验证：

```bash
# 1. 检查文件编码
file --mime-encoding file.md
# 应该输出: file.md: utf-8

# 2. 检查是否有乱码字符
grep '' file.md
# 应该无输出

# 3. 检查箭头符号
grep '→' file.md
# 建议无输出（使用 ASCII 替代）

# 4. 运行质量检查
npm run check-encoding
```

## 紧急修复

如果文件已经包含乱码：

```bash
# 1. 使用 Python 读取并重写（清理编码）
python3 << EOF
with open('file.md', 'r', encoding='utf-8') as f:
    content = f.read()

# 替换易乱码的箭头
content = content.replace('→', '->')
content = content.replace('←', '<-')

with open('file.md', 'w', encoding='utf-8') as f:
    f.write(content)
EOF

# 2. 重新构建
npm run build

# 3. 验证构建质量
bash scripts/verify-build-quality.sh
```

## 示例

### 学习路线（正确示例）

```markdown
> **学习路线**：概念速查 -> 协议拦截 -> Server 实现 -> Client 手写 -> 安全攻防
```

**为什么这样写？**
- ✅ ASCII 箭头 `->` 永远不会乱码
- ✅ 简洁明了
- ✅ 所有浏览器和终端都支持

### 错误示例

```markdown
> **学习路线**：概念速查 → 协议拦截 → Server 实现 → Client 手写 �� 安全攻防
```

**问题**：
- ❌ `→` 箭头可能在某些环境下乱码
- ❌ `��` 是乱码字符
- ❌ 显得不专业

## 自动化检查

构建后自动运行质量检查：

```json
{
  "scripts": {
    "build": "astro build && bash ../scripts/verify-build-quality.sh",
    "build:check": "astro build && bash ../scripts/verify-build-quality.sh"
  }
}
```

## 严格执行

**违反此规则将导致**:
- 构建失败
- Pre-commit 拦截
- PR 无法合并
- 网站显示不专业

**目标**: 零乱码，零错误，专业质量！

---

**版本**: 1.0.0
**生效日期**: 2026-02-07
**执行**: 强制执行，无例外
